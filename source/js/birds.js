!function(){function i(){e.aspect=window.innerWidth/document.getElementById("birds-container").offsetHeight,e.updateProjectionMatrix(),a.setSize(window.innerWidth,document.getElementById("birds-container").offsetHeight)}function t(i){for(var t=new THREE.Vector3(i.clientX-v,-i.clientY+m,0),o=0,n=c.length;o<n;o++)h=c[o],t.z=h.position.z,h.repulse(t)}function o(){requestAnimationFrame(o),n()}function n(){for(var i=0,t=r.length;i<t;i++)(h=c[i]).run(c),(d=r[i]).position.copy(c[i].position),color=d.material.color,color.r=color.g=color.b=(500-d.position.z)/1e3,d.rotation.y=Math.atan2(-h.velocity.z,h.velocity.x),d.rotation.z=Math.asin(h.velocity.y/h.velocity.length()),d.phase=(d.phase+(Math.max(0,d.rotation.z)+.1))%62.83,d.geometry.vertices[5].y=d.geometry.vertices[4].y=5*Math.sin(d.phase);a.render(s,e)}var e,s,a,r,d,h,c,l=function(){var i,t,o=new THREE.Vector3,n=500,e=500,s=200,a=!1;this.position=new THREE.Vector3,this.velocity=new THREE.Vector3,i=new THREE.Vector3,this.setGoal=function(i){t=i},this.setAvoidWalls=function(i){a=i},this.setWorldSize=function(i,t,o){n=i,e=t,s=o},this.run=function(t){a&&(o.set(-n,this.position.y,this.position.z),(o=this.avoid(o)).multiplyScalar(5),i.add(o),o.set(n,this.position.y,this.position.z),(o=this.avoid(o)).multiplyScalar(5),i.add(o),o.set(this.position.x,-e,this.position.z),(o=this.avoid(o)).multiplyScalar(5),i.add(o),o.set(this.position.x,e,this.position.z),(o=this.avoid(o)).multiplyScalar(5),i.add(o),o.set(this.position.x,this.position.y,-s),(o=this.avoid(o)).multiplyScalar(5),i.add(o),o.set(this.position.x,this.position.y,s),(o=this.avoid(o)).multiplyScalar(5),i.add(o)),Math.random()>.5&&this.flock(t),this.move()},this.flock=function(o){t&&i.add(this.reach(t,.005)),i.add(this.alignment(o)),i.add(this.cohesion(o)),i.add(this.separation(o))},this.move=function(){this.velocity.add(i);var t=this.velocity.length();t>4&&this.velocity.divideScalar(t/4),this.position.add(this.velocity),i.set(0,0,0)},this.checkBounds=function(){this.position.x>n&&(this.position.x=-n),this.position.x<-n&&(this.position.x=n),this.position.y>e&&(this.position.y=-e),this.position.y<-e&&(this.position.y=e),this.position.z>s&&(this.position.z=-s),this.position.z<-s&&(this.position.z=s)},this.avoid=function(i){var t=new THREE.Vector3;return t.copy(this.position),t.sub(i),t.multiplyScalar(1/this.position.distanceToSquared(i)),t},this.repulse=function(t){var o=this.position.distanceTo(t);if(o<150){var n=new THREE.Vector3;n.subVectors(this.position,t),n.multiplyScalar(.5/o),i.add(n)}},this.reach=function(i,t){var o=new THREE.Vector3;return o.subVectors(i,this.position),o.multiplyScalar(t),o},this.alignment=function(i){for(var t,o=new THREE.Vector3,n=0,e=0,s=i.length;e<s;e++)Math.random()>.6||(t=i[e],distance=t.position.distanceTo(this.position),distance>0&&distance<=100&&(o.add(t.velocity),n++));if(n>0){o.divideScalar(n);var a=o.length();a>.1&&o.divideScalar(a/.1)}return o},this.cohesion=function(i){for(var t,o,n=new THREE.Vector3,e=new THREE.Vector3,s=0,a=0,r=i.length;a<r;a++)Math.random()>.6||(o=(t=i[a]).position.distanceTo(this.position))>0&&o<=100&&(n.add(t.position),s++);s>0&&n.divideScalar(s),e.subVectors(n,this.position);var d=e.length();return d>.1&&e.divideScalar(d/.1),e},this.separation=function(i){for(var t,o,n=new THREE.Vector3,e=new THREE.Vector3,s=0,a=i.length;s<a;s++)Math.random()>.6||(o=(t=i[s]).position.distanceTo(this.position))>0&&o<=100&&(e.subVectors(this.position,t.position),e.normalize(),e.divideScalar(o),n.add(e));return n}},p=window.innerWidth,u=document.getElementById("birds-container").offsetHeight,v=p/2,m=u/2;!function(){(e=new THREE.PerspectiveCamera(75,p/u,1,1e4)).position.z=300,s=new THREE.Scene,r=[],c=[];for(var o=0;o<10;o++)(h=c[o]=new l).position.x=400*Math.random()-200,h.position.y=400*Math.random()-200,h.position.z=400*Math.random()-200,h.velocity.x=2*Math.random()-1,h.velocity.y=2*Math.random()-1,h.velocity.z=2*Math.random()-1,h.setAvoidWalls(!0),h.setWorldSize(400,400,400),(d=r[o]=new THREE.Mesh(new Bird,new THREE.MeshBasicMaterial({color:16777215*Math.random(),side:THREE.DoubleSide}))).phase=Math.floor(62.83*Math.random()),s.add(d);(a=new THREE.CanvasRenderer({alpha:!0,antialias:!0})).setPixelRatio(window.devicePixelRatio),a.setSize(p,u);var n=document.getElementById("birds-container");n.style.background="none",n.appendChild(a.domElement),n.addEventListener("mousemove",t,!1),window.addEventListener("resize",i,!1)}(),o()}();